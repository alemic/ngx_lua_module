
# Copyright (C) Ngwsx


ngx_addon_name=ngx_lua_module

#NGX_LUA_HTTP=YES
#NGX_LUA_UDP=YES

NGX_LUA_DLL=NO


. $ngx_addon_dir/auto/lib/lua/conf
CORE_LIBS="$CORE_LIBS $LUA_LIBS"
CORE_INCS="$CORE_INCS $LUA_INCS"

#. $ngx_addon_dir/auto/lib/luajit/conf
#CORE_LIBS="$CORE_LIBS $LUAJIT_LIBS"
#CORE_INCS="$CORE_INCS $LUAJIT_INCS"


. $ngx_addon_dir/auto/sources

EVENT_MODULES="$EVENT_MODULES $NGX_LUA_MODULE"
HTTP_INCS="$HTTP_INCS $NGX_LUA_INCS"
NGX_ADDON_DEPS="$NGX_ADDON_DEPS $NGX_LUA_DEPS"
NGX_ADDON_SRCS="$NGX_ADDON_SRCS $NGX_LUA_SRCS"

EVENT_MODULES="$EVENT_MODULES $NGX_LUA_UDP_MODULES"
HTTP_INCS="$HTTP_INCS $NGX_LUA_UDP_INCS"
NGX_ADDON_DEPS="$NGX_ADDON_DEPS $NGX_LUA_UDP_DEPS"
NGX_ADDON_SRCS="$NGX_ADDON_SRCS $NGX_LUA_UDP_SRCS"

HTTP_MODULES="$HTTP_MODULES $NGX_LUA_HTTP_MODULE"
HTTP_INCS="$HTTP_INCS $NGX_LUA_HTTP_INCS"
NGX_ADDON_DEPS="$NGX_ADDON_DEPS $NGX_LUA_HTTP_DEPS"
NGX_ADDON_SRCS="$NGX_ADDON_SRCS $NGX_LUA_HTTP_SRCS"


. $ngx_addon_dir/auto/lib/axis2c/conf
. $ngx_addon_dir/../ngx_dbd_module/auto/lib/libdrizzle/conf
. $ngx_addon_dir/../ngx_dbd_module/auto/lib/sqlite3/conf

CORE_INCS="$CORE_INCS $AXIS2C_INCS"
CORE_INCS="$CORE_INCS $LIBDRIZZLE_INCS"
CORE_INCS="$CORE_INCS $SQLITE3_INCS"

if [ $NGX_LUA_DLL = NO ]; then

    CORE_LIBS="$CORE_LIBS $AXIS2C_LIBS"
    NGX_ADDON_DEPS="$NGX_ADDON_DEPS $NGX_LUA_AXIS2C_DEPS"
    NGX_ADDON_SRCS="$NGX_ADDON_SRCS \
        $NGX_LUA_AXIS2C_SRCS \
        $NGX_LUA_WEBSERVICE_SRCS \
        $NGX_LUA_XML_SRCS"


    CORE_LIBS="$CORE_LIBS $LIBDRIZZLE_LIBS"
    CORE_LIBS="$CORE_LIBS $SQLITE3_LIBS"
    HTTP_INCS="$HTTP_INCS $NGX_LUA_DBD_INCS"
    NGX_ADDON_DEPS="$NGX_ADDON_DEPS $NGX_LUA_DBD_DEPS"
    NGX_ADDON_SRCS="$NGX_ADDON_SRCS $NGX_LUA_DBD_SRCS"


    NGX_ADDON_SRCS="$NGX_ADDON_SRCS \
        $NGX_LUA_DAHUA_SRCS \
        $NGX_LUA_FILE_SRCS \
        $NGX_LUA_LOGGER_SRCS \
        $NGX_LUA_SMTP_SRCS \
        $NGX_LUA_SOCKET_SRCS \
        $NGX_LUA_UTILS_SRCS \
        $NGX_LUA_HTTP_REQUEST_SRCS \
        $NGX_LUA_HTTP_RESPONSE_SRCS \
        $NGX_LUA_HTTP_SESSION_SRCS \
        $NGX_LUA_HTTP_VARIABLE_SRCS"

    have=NGX_LUA_DLL . auto/nohave

else

    if [ "$NGX_PLATFORM" != win32 ]; then
        CORE_LINK="$CORE_LINK -rdynamic"
    else
        NGX_LUA_DEF="$ngx_addon_dir/src/core/ngx_lua.def"
        CORE_LINK="$CORE_LINK -def:$NGX_LUA_DEF"
        CORE_DEPS="$CORE_DEPS $NGX_LUA_DEF"
    fi

    have=NGX_LUA_DLL . auto/have
fi

if [ "$NGX_PLATFORM" != win32 ]; then
    CORE_LINK="$CORE_LINK -ldl"
fi


USE_MD5=YES
USE_SHA1=YES
